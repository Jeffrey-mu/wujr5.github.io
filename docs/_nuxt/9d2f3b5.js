(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{637:function(e,t,o){"use strict";var n=o(2),l=o(57),r=o(638),c=o(265),d=o(5),h=1..toFixed,f=Math.floor,m=function(e,t,o){return 0===t?o:t%2==1?m(e,t-1,o*e):m(e*e,t/2,o)};n({target:"Number",proto:!0,forced:h&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!d((function(){h.call({})}))},{toFixed:function(e){var t,o,n,d,h=r(this),v=l(e),data=[0,0,0,0,0,0],y="",D="0",w=function(e,t){for(var o=-1,n=t;++o<6;)n+=e*data[o],data[o]=n%1e7,n=f(n/1e7)},x=function(e){for(var t=6,o=0;--t>=0;)o+=data[t],data[t]=f(o/e),o=o%e*1e7},_=function(){for(var e=6,s="";--e>=0;)if(""!==s||0===e||0!==data[e]){var t=String(data[e]);s=""===s?t:s+c.call("0",7-t.length)+t}return s};if(v<0||v>20)throw RangeError("Incorrect fraction digits");if(h!=h)return"NaN";if(h<=-1e21||h>=1e21)return String(h);if(h<0&&(y="-",h=-h),h>1e-21)if(o=(t=function(e){for(var t=0,o=e;o>=4096;)t+=12,o/=4096;for(;o>=2;)t+=1,o/=2;return t}(h*m(2,69,1))-69)<0?h*m(2,-t,1):h/m(2,t,1),o*=4503599627370496,(t=52-t)>0){for(w(0,o),n=v;n>=7;)w(1e7,0),n-=7;for(w(m(10,n,1),0),n=t-1;n>=23;)x(1<<23),n-=23;x(1<<n),w(1,1),x(2),D=_()}else w(0,o),w(1<<-t,0),D=_()+c.call("0",v);return D=v>0?y+((d=D.length)<=v?"0."+c.call("0",v-d)+D:D.slice(0,d-v)+"."+D.slice(d-v)):y+D}})},638:function(e,t,o){var n=o(56);e.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},641:function(e,t,o){var content=o(656);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(15).default)("e0e272a0",content,!0,{sourceMap:!1})},655:function(e,t,o){"use strict";o(641)},656:function(e,t,o){var n=o(14)(!1);n.push([e.i,".p-20{padding:20px}.bd-1{border:1px solid #e1e5ee}.br-4{border-radius:4px}.my-10{margin-top:10px;margin-bottom:10px}.h-60{height:60px}.mb-10{margin-bottom:10px}.pl-20{padding-left:20px}.w-600{width:600px}.lh-60{line-height:60px}.w-100{width:100px}.fs-12{font-size:12px}.mr-10{margin-right:10px}.h-300{height:300px}.p-10{padding:10px}.h-30{height:30px}.lh-30{line-height:30px}.mt-10{margin-top:10px}",""]),e.exports=n},678:function(e,t,o){"use strict";o.r(t);o(36),o(12),o(55),o(637);var n=o(122),l=o(67),r=o.n(l),c=o(184),d=o.n(c)()(),h={head:function(){return{title:"资源"+n.a.sPageBaseTitle}},data:function(){return{aResource:[],aEditResource:[],nTotal:0,nSizeTotal:0,bPageLoading:!0,bShowDialog:!1,oDialog:{type:"new",name:"",file:null,url:"",loading:!1}}},computed:{sWriteKey:function(){return this.$store.state.auth.writeKey}},mounted:function(){this.getMediaList()},methods:{copyToClipboard:function(link){this.copy(link),this.$message.success("复制成功")},showDialog:function(e,t){this.oDialog.type=e,"edit"==e?(this.oDialog.id=t.id,this.oDialog.bucket=t.bucket,this.oDialog.name=t.metadata.name,this.oDialog.url=t.url):(this.oDialog.name="",this.oDialog.url=""),this.oDialog.loading=!1,this.bShowDialog=!0},handleChangeFile:function(e){this.oDialog.file=e.target.files[0],"edit"==this.oDialog.type&&(this.oDialog.url=e.target.files[0].name)},saveNewMedia:function(){var e=this;return this.oDialog.name?this.oDialog.file?(this.oDialog.loading=!0,void d.bucket({slug:"4d7c8cd0-2822-11ec-8e75-2f845ec5c57c",write_key:this.sWriteKey}).addMedia({media:this.oDialog.file,metadata:{name:this.oDialog.name}}).then((function(t){e.$message.success("新建成功"),e.bShowDialog=!1,e.getMediaList()})).catch((function(t){e.$message.error("保存失败："+t.message)})).finally((function(){e.oDialog.loading=!1}))):this.$message.warning("需上传文件"):this.$message.warning("需写名称")},updateMedia:function(){var e=this;if(!this.oDialog.name)return this.$message.warning("需写名称");this.oDialog.loading=!0,r.a.patch("https://api.cosmicjs.com/v2/buckets/4d7c8cd0-2822-11ec-8e75-2f845ec5c57c/media/".concat(this.oDialog.id),{headers:{Authorization:this.sWriteKey},data:{metadata:{name:this.oDialog.name}}}).then((function(t){e.$message.success("修改成功"),e.bShowDialog=!1,e.getMediaList()})).catch((function(t){e.$message.error("修改失败："+t.message)})).finally((function(){e.oDialog.loading=!1}))},deleteMedia:function(e){var t=this;this.$confirm("确认删除？").then((function(){e.loading=!0,d.bucket({slug:"4d7c8cd0-2822-11ec-8e75-2f845ec5c57c",write_key:t.sWriteKey}).deleteMedia({id:e.id}).then((function(e){t.$message.success("删除成功"),t.getMediaList()})).catch((function(e){t.$message.error("删除失败："+e.message)}))})).catch((function(){}))},getMediaList:function(){var e=this;this.bPageLoading=!0,d.bucket({slug:"4d7c8cd0-2822-11ec-8e75-2f845ec5c57c",read_key:"KW8eCqNzGJ8U05aYWCUNHKueNH5COLxAOv1Ou71XIPArrTIDeU"}).getMedia({sort:"created_at",limit:100}).then((function(t){e.aResource=t.media.map((function(i){return i.loading=!1,i})),e.nTotal=t.total,e.nSizeTotal=(t.media.reduce((function(e,t){return e+t.size}),0)/1e6).toFixed(2)})).finally((function(){e.bPageLoading=!1}))},copy:function(text){var input=document.createElement("textarea");input.innerHTML=text,document.body.appendChild(input),input.select();var e=document.execCommand("copy");return document.body.removeChild(input),e}}},f=(o(655),o(34)),component=Object(f.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"p-20"},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.bPageLoading,expression:"bPageLoading"}]},[o("h2",[e._v("资源（数量："+e._s(e.nTotal)+"，大小："+e._s(e.nSizeTotal)+" M）"),e.sWriteKey?o("div",{staticClass:"fl-r"},[o("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.showDialog("new")}}},[e._v("添加")])],1):e._e()]),o("div",e._l(e.aResource,(function(t,n){return o("div",{key:"resource-"+n,staticClass:"bd-1 br-4 my-10 h-60 mb-10 pst-rlt pl-20"},[o("a",{staticClass:"inbl vtal-top w-600 lh-60",attrs:{href:t.url,target:"_blank"}},[e._v(e._s(t.metadata.name))]),o("div",{staticClass:"inbl vtal-top w-100 lh-60 fs-12 c-gray"},[e._v(e._s((t.size/1e3/1e3).toFixed(2))+" M")]),e.sWriteKey?o("div",{staticClass:"fl-r inbl vtal-top mr-10 lh-60"},[o("el-button",{attrs:{size:"mini",type:"danger",loading:t.loading},on:{click:function(o){return e.deleteMedia(t)}}},[e._v("删除")]),o("el-button",{attrs:{size:"mini",type:"primary",loading:t.loading},on:{click:function(o){return e.showDialog("edit",t)}}},[e._v("修改")])],1):e._e(),o("div",{staticClass:"fl-r lh-60 mr-10"},[o("span",{staticClass:"fs-12 c-gray cs-pt",on:{click:function(o){return e.copyToClipboard(t.url)}}},[e._v("复制链接")])])])})),0)]),o("el-dialog",{attrs:{title:"new"==e.oDialog.type?"新建":"编辑",visible:e.bShowDialog,width:"500px"},on:{"update:visible":function(t){e.bShowDialog=t}}},[o("div",{staticClass:"h-300 bg-text p-10"},[o("div",[o("div",{staticClass:"h-30 lh-30"},[e._v("名称")]),o("el-input",{attrs:{size:"small"},model:{value:e.oDialog.name,callback:function(t){e.$set(e.oDialog,"name",t)},expression:"oDialog.name"}})],1),o("div",{staticClass:"mt-10"},[o("div",{staticClass:"h-30 lh-30"},[e._v("文件")]),"new"==e.oDialog.type?o("input",{attrs:{type:"file",size:"mini",plain:"",round:""},on:{change:function(t){return e.handleChangeFile(t)}}}):o("div",[o("div",{staticClass:"c-gray"},[e._v(e._s(e.oDialog.url))])])])]),o("div",{attrs:{slot:"footer"},slot:"footer"},["new"==e.oDialog.type?o("el-button",{attrs:{size:"mini",type:"success",loading:e.oDialog.loading},on:{click:e.saveNewMedia}},[e._v("新建")]):o("el-button",{attrs:{size:"mini",type:"primary",loading:e.oDialog.loading},on:{click:e.updateMedia}},[e._v("保存")])],1)])],1)}),[],!1,null,null,null);t.default=component.exports}}]);